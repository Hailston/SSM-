<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hngy.mapper.StudentMapper">
    <!-- 添加学生信息记录 -->
    <insert id="addStudent">
        insert into student(sno, username, sex, password, department, jiguan, mark, email, image, tel, maxClasses)
        values (#{sno}, #{username}, #{sex}, #{password}, #{department}, #{jiguan}, #{mark}, #{email}, #{image}, #{tel},
                #{maxClasses})
    </insert>
    <insert id="insertBatch">
        insert into student(sno,username, sex, password, department, jiguan, mark, email, tel, maxClasses) values
        <foreach collection="students" item="item" separator=",">
			(#{item.sno}, #{item.username}, #{item.sex}, #{item.password}, #{item.department},#{item.jiguan}, #{item.mark}, #{item.email}, #{item.tel},#{item.maxClasses})
        </foreach>
    </insert>


    <select id="listAll" resultType="student">
        select *
        from student
    </select>
    <resultMap id="studentMap" type="student">
        <id property="studentNumber" column="studentNumber"/>
        <association property="studentClassNumber" column="studentClassNumber"
                     select="com.chengxusheji.mapper.ClassInfoMapper.getClassInfo"/>
    </resultMap>

    <!-- 按照查询条件查询所有学生信息记录 -->
    <select id="queryStudentList" resultMap="studentMap">
        select t_student.*
        from t_student,
             t_classInfo ${where} and t_student.studentClassNumber = t_classInfo.classNumber
    </select>

    <!-- 按照查询条件的学生信息记录数 -->
    <select id="queryStudentCount" resultType="int">
        select count(*)
        from t_student,
             t_classInfo ${where} and t_student.studentClassNumber = t_classInfo.classNumber
    </select>

    <!-- 根据主键查询某个学生信息记录 -->
    <select id="getStudent" resultType="student">
        select *
        from student
        where sno = #{sno}
    </select>

    <!-- 更新学生信息记录 -->
    <update id="updateStudent" parameterType="student">
        update t_student
        set studentName=#{studentName},
            studentPassword=#{studentPassword},
            studentSex=#{studentSex},
            studentClassNumber=#{studentClassNumber.classNumber},
            studentBirthday=#{studentBirthday},
            studentState=#{studentState},
            studentPhoto=#{studentPhoto},
            studentTelephone=#{studentTelephone},
            studentEmail=#{studentEmail},
            studentQQ=#{studentQQ},
            studentAddress=#{studentAddress},
            studentMemo=#{studentMemo}
        where studentNumber = #{studentNumber}
    </update>
    <update id="changePassword">
        update student set password=#{newPassword} where sno=#{sno} and password=#{oldPassword}
    </update>

    <!-- 删除学生信息记录 -->
    <delete id="deleteStudent" parameterType="string">
        delete
        from t_student
        where studentNumber = #{studentNumber}
    </delete>

</mapper>
